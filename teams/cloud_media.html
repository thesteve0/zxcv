
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cloud-Backed Media â€” FiftyOne 1.3.0 documentation</title>
<link href="../_static/favicon.ico" rel="shortcut icon"/>
<link href="../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
<link href="../_static/css/voxel51-website.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="roles_and_permissions.html" rel="next" title="Roles and permissions"/>
<link href="api_connection.html" rel="prev" title="API Connection"/>
<meta content="https://voxel51.com/wp-content/uploads/2024/03/3.24_webpages_Home_AV.png" property="og:image">
<link href="https://fonts.googleapis.com/css?family=Palanquin:400,600,700,800" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" rel="stylesheet"/>
<script src="https://tag.clearbitscripts.com/v1/pk_b9ed71c8234edd4f77326bcbfab5a4ca/tags.js"></script>
<script src="../_static/js/modernizr.min.js"></script>
</meta></head>

<body class="pytorch-body">
<div class="table-of-contents-link-wrapper">
<span>Table of Contents</span>
<a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="#"></a>
</div>
<nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu">
<div class="pytorch-side-scroll">
<div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
<div class="pytorch-left-menu-search">
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search Docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">FiftyOne Teams ðŸš€</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/index.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes/index.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheets/index.html">Cheat Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset_zoo/index.html">Dataset Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_zoo/index.html">Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../brain.html">FiftyOne Brain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations/index.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/fiftyone.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deprecation.html">Deprecation Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>
</div>
</div>
</nav>
<div class="pytorch-container">
<div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
<div class="pytorch-breadcrumbs-wrapper">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="pytorch-breadcrumbs">
<li>
<a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>
<li><a href="index.html">FiftyOne Teams</a> &gt;</li>
<li>Cloud-Backed Media</li>
<li class="pytorch-breadcrumbs-aside">
</li>
</ul>
</div>
</div>
<div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Contents
        </div>
</div>
<section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
<div class="pytorch-content-left">
<div class="rst-content style-external-links">
<div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
<div class="section" id="cloud-backed-media">
<span id="teams-cloud-media"></span><h1>Cloud-Backed Media<a class="headerlink" href="#cloud-backed-media" title="Permalink to this headline">Â¶</a></h1>
<p>FiftyOne Teams datasets may contain samples whose filepath refers to cloud
object storage paths and/or publicly available URLs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="installation.html#teams-cloud-credentials"><span class="std std-ref">Click here</span></a> to see how to configure FiftyOne
Teams to load your cloud credentials!</p>
</div>
<div class="section" id="cloud-media-caching">
<span id="teams-cloud-media-caching"></span><h2>Cloud media caching<a class="headerlink" href="#cloud-media-caching" title="Permalink to this headline">Â¶</a></h2>
<p>When you work with cloud-backed datasets using the
<a class="reference internal" href="installation.html#teams-python-sdk"><span class="std std-ref">Teams SDK</span></a>, media files will automatically be
downloaded and cached on the machine youâ€™re working from when you execute
workflows such as model inference or Brain methods that require access to the
pixels of the media files. This design minimizes bandwidth usage and can
significantly improve performance in workflows where you access the same media
file repeatedly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>
<span class="kn">import</span> <span class="nn">fiftyone.brain</span> <span class="k">as</span> <span class="nn">fob</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">"a-teams-dataset"</span><span class="p">)</span>

<span class="c1"># Automatically downloads cloud media to your local cache for processing</span>
<span class="n">fob</span><span class="o">.</span><span class="n">compute_visualization</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">brain_key</span><span class="o">=</span><span class="s2">"img_viz"</span><span class="p">)</span>
</pre></div>
</div>
<p>When launching the App locally using the Teams SDK, media will be served from
your local cache whenever possible; otherwise it will be automatically
retrieved from the cloud:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">"a-teams-dataset"</span><span class="p">)</span>

<span class="c1"># Any media you view will be automatically retrieved from the cloud</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, viewing media in the App will not add it to your local media cache,
but, if desired, you can enable caching of images via the <code class="code docutils literal notranslate"><span class="pre">cache_app_images</span></code>
parameter of your <a class="reference internal" href="#teams-media-cache-config"><span class="std std-ref">media cache config</span></a>. Viewing
video datasets in the App will never cause previously uncached videos to be
cached locally.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We recommend that you populate the metadata on your datasets at creation
time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">compute_metadata</span><span class="p">()</span>
</pre></div>
</div>
<p>so that the dimensions of all media stored in the cloud are readily
available when viewing datasets in the App. Otherwise, the App must pull
this metadata each time you view a sample.</p>
</div>
</div>
<div class="section" id="media-cache-config">
<span id="teams-media-cache-config"></span><h2>Media cache config<a class="headerlink" href="#media-cache-config" title="Permalink to this headline">Â¶</a></h2>
<p>By default, your local media cache is located at <code class="code docutils literal notranslate"><span class="pre">~/fiftyone/__cache__</span></code>, has
a size of 32GB, will download media in batches of 128MB when using
<code class="code docutils literal notranslate"><span class="pre">download_context()</span></code>, and will use a thread pool whose size equals the number
of virtual CPU cores on your machine to download media files.</p>
<p>When the cache is full, local files are automatically deleted in reverse order
of when they were last accessed (i.e., oldest deleted first).</p>
<p>You can configure the behavior of FiftyOne Teamâ€™s media cache in any of the
following ways.</p>
<p>1. Configure your media cache on a per-session basis by setting any of the
following environment variables (default values shown):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_MEDIA_CACHE_DIR</span><span class="o">=</span>/path/for/media-cache
<span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_MEDIA_CACHE_SIZE_BYTES</span><span class="o">=</span><span class="m">34359738368</span><span class="w">  </span><span class="c1"># 32GB</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_MEDIA_CACHE_DOWNLOAD_SIZE_BYTES</span><span class="o">=</span><span class="m">134217728</span><span class="w">  </span><span class="c1"># 128MB</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_MEDIA_CACHE_NUM_WORKERS</span><span class="o">=</span><span class="m">16</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_MEDIA_CACHE_APP_IMAGES</span><span class="o">=</span><span class="nb">false</span>
</pre></div>
</div>
<p>2. Create a media cache config file at <code class="code docutils literal notranslate"><span class="pre">~/.fiftyone/media_cache_config.json</span></code>
that contains any of the following keys (default values shown):</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">"cache_dir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/path/for/media-cache"</span><span class="p">,</span>
<span class="w">    </span><span class="nt">"cache_size_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">34359738368</span><span class="p">,</span>
<span class="w">    </span><span class="nt">"download_size_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">134217728</span><span class="p">,</span>
<span class="w">    </span><span class="nt">"num_workers"</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">    </span><span class="nt">"cache_app_images"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can change the location of this file by setting the
<code class="code docutils literal notranslate"><span class="pre">FIFTYONE_MEDIA_CACHE_CONFIG_PATH</span></code> environment variable.</p>
<p>If you combine multiple options above, environment variables will take
precedence over JSON config settings.</p>
</div>
<div class="section" id="working-with-cloud-backed-datasets">
<span id="teams-cloud-media-python"></span><h2>Working with cloud-backed datasets<a class="headerlink" href="#working-with-cloud-backed-datasets" title="Permalink to this headline">Â¶</a></h2>
<p>When writing Python code using the Teams client that may involve cloud-backed
datasets, use <code class="code docutils literal notranslate"><span class="pre">sample.local_path</span></code> instead of <code class="code docutils literal notranslate"><span class="pre">sample.filepath</span></code> to retrieve
the location of the locally cached version of a media file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">"a-teams-dataset"</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
<span class="c1"># ex: s3://voxel51-test/images/000001.jpg</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">local_path</span><span class="p">)</span>
<span class="c1"># ex: ~/fiftyone/__cache__/media/s3/voxel51-test/images/000001.jpg</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">sample.filepath</span></code> itself is a local path, then <code class="code docutils literal notranslate"><span class="pre">sample.local_path</span></code>
will simply return that path. In other words, it is safe to write all Teams
Python code as if the dataset contains cloud-backed media.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you access <code class="code docutils literal notranslate"><span class="pre">sample.local_path</span></code> and the corresponding media file is not
cached locally, it will immediately be downloaded.</p>
</div>
<p>You can use <code class="code docutils literal notranslate"><span class="pre">download_media()</span></code> to efficiently download and cache the source
media files for an entire dataset or view using the cacheâ€™s full thread pool to
maximize throughput:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>

<span class="c1"># Download media for a view</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">()</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">download_media</span><span class="p">()</span>

<span class="c1"># Download all media in the dataset</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">download_media</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="code docutils literal notranslate"><span class="pre">download_media()</span></code> will automatically skip any already cached
media.</p>
</div>
<p>You can also use <code class="code docutils literal notranslate"><span class="pre">download_context()</span></code> to download smaller batches of media
when iterating over samples in a collection:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">"a-teams-dataset"</span><span class="p">)</span>

<span class="c1"># Download media using the default batching strategy</span>
<span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">download_context</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="n">sample</span><span class="o">.</span><span class="n">local_path</span>  <span class="c1"># already downloaded</span>

<span class="c1"># Download media in batches of 50MB</span>
<span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">download_context</span><span class="p">(</span><span class="n">target_size_bytes</span><span class="o">=</span><span class="mi">50</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="n">sample</span><span class="o">.</span><span class="n">local_path</span>  <span class="c1"># already downloaded</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can configure the default size of each download batch via the
<code class="docutils literal notranslate"><span class="pre">download_size_bytes</span></code> parameter of your
<a class="reference internal" href="#teams-media-cache-config"><span class="std std-ref">media cache config</span></a>.</p>
</div>
<p>Download contexts provide a middle ground between the two extremes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download all media in advance</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">download_media</span><span class="p">()</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
    <span class="n">sample</span><span class="o">.</span><span class="n">local_path</span>  <span class="c1"># already downloaded</span>

<span class="c1"># Download individual images just in time</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
    <span class="n">sample</span><span class="o">.</span><span class="n">local_path</span>   <span class="c1"># downloads media now</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Download contexts are useful if your cache is not large enough to store all
the media in the dataset youâ€™re working with simultaneously.</p>
</div>
<p>You can also use <code class="code docutils literal notranslate"><span class="pre">get_local_paths()</span></code> to retrieve the list of local paths
for each sample in a potentially cloud-backed dataset or view:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># These methods support full datasets or views into them</span>
<span class="n">sample_collection</span> <span class="o">=</span> <span class="n">dataset</span>
<span class="c1"># sample_collection = dataset.limit(10)</span>

<span class="c1"># Retrieve the local paths for all media in a collection</span>
<span class="n">local_paths</span> <span class="o">=</span> <span class="n">sample_collection</span><span class="o">.</span><span class="n">get_local_paths</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">local_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># ex: ~/fiftyone/__cache__/media/s3/voxel51-test/images/000001.jpg</span>

<span class="c1"># Retrieve the possibly-cloud paths for all media in a collection</span>
<span class="n">cloud_paths</span> <span class="o">=</span> <span class="n">sample_collection</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s2">"filepath"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">cloud_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># ex: s3://voxel51-test/images/000001.jpg</span>
</pre></div>
</div>
<p>You can get information about currently cached media files for a sample
collection by calling <code class="code docutils literal notranslate"><span class="pre">cache_stats()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># View cache stats for the current collection</span>
<span class="n">sample_collection</span><span class="o">.</span><span class="n">cache_stats</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{'cache_dir': '~/fiftyone/__cache__',
 'cache_size': 34359738368,
 'cache_size_str': '32.0GB',
 'current_size': 24412374,
 'current_size_str': '23.3MB',
 'current_count': 200,
 'load_factor': 0.000710493593942374}
</pre></div>
</div>
<p>and you can call <code class="code docutils literal notranslate"><span class="pre">clear_media()</span></code> to delete any cached copies of media in the
collection:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clear this collection's media from the cache</span>
<span class="n">sample_collection</span><span class="o">.</span><span class="n">clear_media</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also perform these operations on the full cache as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># View global cache stats</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fo</span><span class="o">.</span><span class="n">media_cache</span><span class="o">.</span><span class="n">stats</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{'cache_dir': '~/fiftyone/__cache__',
 'cache_size': 34359738368,
 'cache_size_str': '32.0GB',
 'current_size': 49097587,
 'current_size_str': '46.8MB',
 'current_count': 600,
 'load_factor': 0.0014289278478827327}
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clear the entire cache</span>
<span class="n">fo</span><span class="o">.</span><span class="n">media_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">fiftyone.core.storage</span></code> module also provides a number of convenient
methods that can be used to manipulate cloud and/or local media.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">upload_media()</span></code> method provides a convenient wrapper for uploading a local
datasetâ€™s media to the cloud:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone.core.storage</span> <span class="k">as</span> <span class="nn">fos</span>

<span class="c1"># Create a dataset from media stored locally</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span><span class="s2">"/tmp/local"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

<span class="c1"># Upload the dataset's media to the cloud</span>
<span class="n">fos</span><span class="o">.</span><span class="n">upload_media</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">,</span>
    <span class="s2">"s3://voxel51-test/your-media"</span><span class="p">,</span>
    <span class="n">update_filepaths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">fiftyone.core.storage</span></code> module also provides a number of lower-level
methods that you can use to work with cloud and local assets.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone.core.storage</span> <span class="k">as</span> <span class="nn">fos</span>

<span class="n">s3_paths</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"s3://voxel51-test/images/000001.jpg"</span><span class="p">,</span>
    <span class="s2">"s3://voxel51-test/images/000002.jpg"</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">]</span>

<span class="n">gcs_paths</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"gs://voxel51-test/images/000001.jpg"</span><span class="p">,</span>
    <span class="s2">"gs://voxel51-test/images/000002.jpg"</span><span class="p">,</span>
    <span class="o">...</span>

<span class="p">]</span>

<span class="n">local_paths</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"/tmp/voxel51-test/images/000001.jpg"</span><span class="p">,</span>
    <span class="s2">"/tmp/voxel51-test/images/000002.jpg"</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>For example, you can use <code class="code docutils literal notranslate"><span class="pre">list_files()</span></code> to list the contents of a folder:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cloud_paths</span> <span class="o">=</span> <span class="n">fos</span><span class="o">.</span><span class="n">list_files</span><span class="p">(</span>
    <span class="s2">"s3://voxel51-test"</span><span class="p">,</span> <span class="n">abs_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">cloud_paths</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># ex: s3://voxel51-test/images/000001.jpg</span>
</pre></div>
</div>
<p>or you can use <code class="code docutils literal notranslate"><span class="pre">copy_files()</span></code> and <code class="code docutils literal notranslate"><span class="pre">move_files()</span></code> to transfer files between
destinations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># S3 -&gt; local</span>
<span class="n">fos</span><span class="o">.</span><span class="n">copy_files</span><span class="p">(</span><span class="n">s3_paths</span><span class="p">,</span> <span class="n">local_paths</span><span class="p">)</span>
<span class="n">fos</span><span class="o">.</span><span class="n">move_files</span><span class="p">(</span><span class="n">s3_paths</span><span class="p">,</span> <span class="n">local_paths</span><span class="p">)</span>

<span class="c1"># local -&gt; S3</span>
<span class="n">fos</span><span class="o">.</span><span class="n">copy_files</span><span class="p">(</span><span class="n">local_paths</span><span class="p">,</span> <span class="n">s3_paths</span><span class="p">)</span>
<span class="n">fos</span><span class="o">.</span><span class="n">move_files</span><span class="p">(</span><span class="n">local_paths</span><span class="p">,</span> <span class="n">s3_paths</span><span class="p">)</span>

<span class="c1"># S3 -&gt; GCS</span>
<span class="n">fos</span><span class="o">.</span><span class="n">copy_files</span><span class="p">(</span><span class="n">s3_paths</span><span class="p">,</span> <span class="n">gcs_paths</span><span class="p">)</span>
<span class="n">fos</span><span class="o">.</span><span class="n">move_files</span><span class="p">(</span><span class="n">s3_paths</span><span class="p">,</span> <span class="n">gcs_paths</span><span class="p">)</span>
</pre></div>
</div>
<p>or you can use <code class="code docutils literal notranslate"><span class="pre">delete_files()</span></code> to delete assets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fos</span><span class="o">.</span><span class="n">delete_files</span><span class="p">(</span><span class="n">s3_paths</span><span class="p">)</span>
<span class="n">fos</span><span class="o">.</span><span class="n">delete_files</span><span class="p">(</span><span class="n">gcs_paths</span><span class="p">)</span>
<span class="n">fos</span><span class="o">.</span><span class="n">delete_files</span><span class="p">(</span><span class="n">local_paths</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All of the above methods use the media cacheâ€™s thread pool to maximize
throughput.</p>
</div>
</div>
<div class="section" id="api-reference">
<span id="teams-cloud-api-reference"></span><h2>API reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="dataset-methods">
<h3><code class="code docutils literal notranslate"><span class="pre">Dataset</span></code> methods<a class="headerlink" href="#dataset-methods" title="Permalink to this headline">Â¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>import fiftyone as fo

fo.Dataset.download_media?
fo.Dataset.download_scenes?
fo.Dataset.download_context?
fo.Dataset.get_local_paths?
fo.Dataset.cache_stats?
fo.Dataset.clear_media?
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">download_media</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">media_fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_slices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">include_assets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_failures</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Downloads the source media files for all samples in the collection.</span>

<span class="sd">    This method is only useful for collections that contain remote media.</span>

<span class="sd">    Any existing files are not re-downloaded, unless ``update == True`` and</span>
<span class="sd">    their checksums no longer match.</span>

<span class="sd">    Args:</span>
<span class="sd">        media_fields (None): a field or iterable of fields containing media</span>
<span class="sd">            to download. By default, all media fields in the collection's</span>
<span class="sd">            :meth:`app_config` are used</span>
<span class="sd">        group_slices (None): an optional subset of group slices for which</span>
<span class="sd">            to download media. Only applicable when the collection contains</span>
<span class="sd">            groups</span>
<span class="sd">        include_assets (True): whether to include 3D scene assets</span>
<span class="sd">        update (False): whether to re-download media whose checksums no</span>
<span class="sd">            longer match</span>
<span class="sd">        skip_failures (True): whether to gracefully continue without</span>
<span class="sd">            raising an error if a remote file cannot be downloaded</span>
<span class="sd">        progress (None): whether to render a progress bar tracking the</span>
<span class="sd">            progress of any downloads (True/False), use the default value</span>
<span class="sd">            ``fiftyone.config.show_progress_bars`` (None), or a progress</span>
<span class="sd">            callback function to invoke instead</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">download_scenes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_failures</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Downloads all ``.fo3d`` files for the samples in the collection.</span>

<span class="sd">    This method is only useful for collections that contain remote media.</span>

<span class="sd">    Any existing files are not re-downloaded, unless ``update == True`` and</span>
<span class="sd">    their checksums no longer match.</span>

<span class="sd">    Args:</span>
<span class="sd">        update (False): whether to re-download files whose checksums no</span>
<span class="sd">            longer match</span>
<span class="sd">        skip_failures (True): whether to gracefully continue without</span>
<span class="sd">            raising an error if a remote file cannot be downloaded</span>
<span class="sd">        progress (None): whether to render a progress bar tracking the</span>
<span class="sd">            progress of any downloads (True/False), use the default value</span>
<span class="sd">            ``fiftyone.config.show_progress_bars`` (None), or a progress</span>
<span class="sd">            callback function to invoke instead</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">download_context</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">target_size_bytes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">media_fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_slices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">include_assets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_failures</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Returns a context that can be used to pre-download media in batches</span>
<span class="sd">    when iterating over samples in this collection.</span>

<span class="sd">    This method is only useful for collections that contain remote media.</span>

<span class="sd">    By default, all media will be downloaded when the context is entered,</span>
<span class="sd">    but you can configure a batching strategy via the `batch_size` or</span>
<span class="sd">    `target_size_bytes` parameters.</span>

<span class="sd">    If no ``batch_size`` or ``target_size_bytes`` is provided, media are</span>
<span class="sd">    downloaded in batches of ``fo.media_cache_config.download_size_bytes``.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_size (None): a sample batch size to use for each download</span>
<span class="sd">        target_size_bytes (None): a target content size, in bytes, for each</span>
<span class="sd">            download batch. If negative, all media is downloaded in one</span>
<span class="sd">            batch</span>
<span class="sd">        media_fields (None): a field or iterable of fields containing media</span>
<span class="sd">            to download. By default, all media fields in the collection's</span>
<span class="sd">            :meth:`app_config` are used</span>
<span class="sd">        group_slices (None): an optional subset of group slices to download</span>
<span class="sd">            media for. Only applicable when the collection contains groups</span>
<span class="sd">        include_assets (True): whether to include 3D scene assets</span>
<span class="sd">        update (False): whether to re-download media whose checksums no</span>
<span class="sd">            longer match</span>
<span class="sd">        skip_failures (True): whether to gracefully continue without</span>
<span class="sd">            raising an error if a remote file cannot be downloaded</span>
<span class="sd">        clear (False): whether to clear the media from the cache when the</span>
<span class="sd">            context exits</span>
<span class="sd">        progress (None): whether to render a progress bar tracking the</span>
<span class="sd">            progress of any downloads (True/False), use the default value</span>
<span class="sd">            ``fiftyone.config.show_progress_bars`` (None), or a progress</span>
<span class="sd">            callback function to invoke instead</span>
<span class="sd">        **kwargs: valid keyword arguments for :meth:`download_media`</span>

<span class="sd">    Returns:</span>
<span class="sd">        a :class:`DownloadContext`</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">get_local_paths</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">media_field</span><span class="o">=</span><span class="s2">"filepath"</span><span class="p">,</span>
    <span class="n">include_assets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">skip_failures</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Returns a list of local paths to the media files in this collection.</span>

<span class="sd">    This method is only useful for collections that contain remote media.</span>

<span class="sd">    Args:</span>
<span class="sd">        media_field ("filepath"): the field containing the media paths</span>
<span class="sd">        include_assets (True): whether to include 3D scene assets</span>
<span class="sd">        download (True): whether to download any non-cached media files</span>
<span class="sd">        skip_failures (True): whether to gracefully continue without</span>
<span class="sd">            raising an error if a remote file cannot be downloaded</span>
<span class="sd">        progress (None): whether to render a progress bar tracking the</span>
<span class="sd">            progress of any downloads (True/False), use the default value</span>
<span class="sd">            ``fiftyone.config.show_progress_bars`` (None), or a progress</span>
<span class="sd">            callback function to invoke instead</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of local filepaths</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">cache_stats</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">media_fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_slices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">include_assets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Returns a dictionary of stats about the cached media files in this</span>
<span class="sd">    collection.</span>

<span class="sd">    This method is only useful for collections that contain remote media.</span>

<span class="sd">    Args:</span>
<span class="sd">        media_fields (None): a field or iterable of fields containing media</span>
<span class="sd">            paths. By default, all media fields in the collection's</span>
<span class="sd">            :meth:`app_config` are included</span>
<span class="sd">        group_slices (None): an optional subset of group slices to include.</span>
<span class="sd">            Only applicable when the collection contains groups</span>
<span class="sd">        include_assets (True): whether to include 3D scene assets</span>

<span class="sd">    Returns:</span>
<span class="sd">        a stats dict</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fo</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">clear_media</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">media_fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_slices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">include_assets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Deletes any local copies of media files in this collection from the</span>
<span class="sd">    media cache.</span>

<span class="sd">    This method is only useful for collections that contain remote media.</span>

<span class="sd">    Args:</span>
<span class="sd">        media_fields (None): a field or iterable of fields containing media</span>
<span class="sd">            paths to clear from the cache. By default, all media fields</span>
<span class="sd">            in the collection's :meth:`app_config` are cleared</span>
<span class="sd">        group_slices (None): an optional subset of group slices for which</span>
<span class="sd">            to clear media. Only applicable when the collection contains</span>
<span class="sd">            groups</span>
<span class="sd">        include_assets (True): whether to include 3D scene assets</span>
<span class="sd">    """</span>
</pre></div>
</div>
</div>
<div class="section" id="fiftyone-core-storage">
<h3><code class="code docutils literal notranslate"><span class="pre">fiftyone.core.storage</span></code><a class="headerlink" href="#fiftyone-core-storage" title="Permalink to this headline">Â¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>import fiftyone.core.storage as fos

fos.list_files?
fos.copy_files?
fos.move_files?
fos.delete_files?
fos.upload_media?
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fos</span><span class="o">.</span><span class="n">list_files</span><span class="p">(</span>
    <span class="n">dirpath</span><span class="p">,</span>
    <span class="n">abs_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">include_hidden_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Lists the files in the given directory.</span>

<span class="sd">    If the directory does not exist, an empty list is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        dirpath: the path to the directory to list</span>
<span class="sd">        abs_paths (False): whether to return the absolute paths to the files</span>
<span class="sd">        recursive (False): whether to recursively traverse subdirectories</span>
<span class="sd">        include_hidden_files (False): whether to include dot files</span>
<span class="sd">        sort (True): whether to sort the list of files</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of filepaths</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fos</span><span class="o">.</span><span class="n">copy_files</span><span class="p">(</span><span class="n">inpaths</span><span class="p">,</span> <span class="n">outpaths</span><span class="p">,</span> <span class="n">skip_failures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Copies the files to the given locations.</span>

<span class="sd">    Args:</span>
<span class="sd">        inpaths: a list of input paths</span>
<span class="sd">        outpaths: a list of output paths</span>
<span class="sd">        skip_failures (False): whether to gracefully continue without</span>
<span class="sd">            raising an error if a remote operation fails</span>
<span class="sd">        progress (None): whether to render a progress bar (True/False), use the</span>
<span class="sd">            default value ``fiftyone.config.show_progress_bars`` (None), or a</span>
<span class="sd">            progress callback function to invoke instead</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fos</span><span class="o">.</span><span class="n">move_files</span><span class="p">(</span><span class="n">inpaths</span><span class="p">,</span> <span class="n">outpaths</span><span class="p">,</span> <span class="n">skip_failures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Moves the files to the given locations.</span>

<span class="sd">    Args:</span>
<span class="sd">        inpaths: a list of input paths</span>
<span class="sd">        outpaths: a list of output paths</span>
<span class="sd">        skip_failures (False): whether to gracefully continue without raising</span>
<span class="sd">            an error if a remote operation fails</span>
<span class="sd">        progress (None): whether to render a progress bar (True/False), use the</span>
<span class="sd">            default value ``fiftyone.config.show_progress_bars`` (None), or a</span>
<span class="sd">            progress callback function to invoke instead</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fos</span><span class="o">.</span><span class="n">delete_files</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">skip_failures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Deletes the files from the given locations.</span>

<span class="sd">    For local paths, any empty directories are also recursively deleted from</span>
<span class="sd">    the resulting directory tree.</span>

<span class="sd">    Args:</span>
<span class="sd">        paths: a list of paths</span>
<span class="sd">        skip_failures (False): whether to gracefully continue without raising</span>
<span class="sd">            an error if a remote operation fails</span>
<span class="sd">        progress (None): whether to render a progress bar (True/False), use the</span>
<span class="sd">            default value ``fiftyone.config.show_progress_bars`` (None), or a</span>
<span class="sd">            progress callback function to invoke instead</span>
<span class="sd">    """</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fos</span><span class="o">.</span><span class="n">upload_media</span><span class="p">(</span>
    <span class="n">sample_collection</span><span class="p">,</span>
    <span class="n">remote_dir</span><span class="p">,</span>
    <span class="n">rel_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">media_field</span><span class="o">=</span><span class="s2">"filepath"</span><span class="p">,</span>
    <span class="n">update_filepaths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_failures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Uploads the source media files for the given collection to the given</span>
<span class="sd">    remote directory.</span>

<span class="sd">    Providing a ``rel_dir`` enables writing nested subfolders within</span>
<span class="sd">    ``remote_dir`` matching the structure of the input collection's media. By</span>
<span class="sd">    default, the files are written directly to ``remote_dir`` using their</span>
<span class="sd">    basenames.</span>

<span class="sd">    Args:</span>
<span class="sd">        sample_collection: a</span>
<span class="sd">            :class:`fiftyone.core.collections.SampleCollection`</span>
<span class="sd">        remote_dir: a remote "folder" into which to upload</span>
<span class="sd">        rel_dir (None): an optional relative directory to strip from each</span>
<span class="sd">            filepath when constructing the corresponding remote path</span>
<span class="sd">        media_field ("filepath"): the field containing the media paths</span>
<span class="sd">        update_filepaths (False): whether to update the ``media_field`` of each</span>
<span class="sd">            sample in the collection to its remote path</span>
<span class="sd">        cache (False): whether to store the uploaded media in your local media</span>
<span class="sd">            cache. The supported values are:</span>

<span class="sd">            -   ``False`` (default): do not cache the media</span>
<span class="sd">            -   ``True`` or ``"copy"``: copy the media into your local cache</span>
<span class="sd">            -   ``"move"``: move the media into your local cache</span>
<span class="sd">        overwrite (False): whether to overwrite (True) or skip (False) existing</span>
<span class="sd">            remote files</span>
<span class="sd">        skip_failures (False): whether to gracefully continue without raising</span>
<span class="sd">            an error if a remote operation fails</span>
<span class="sd">        progress (None): whether to render a progress bar (True/False), use the</span>
<span class="sd">            default value ``fiftyone.config.show_progress_bars`` (None), or a</span>
<span class="sd">            progress callback function to invoke instead</span>

<span class="sd">    Returns:</span>
<span class="sd">        the list of remote paths</span>
<span class="sd">    """</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="annotating-cloud-backed-datasets-with-cvat">
<span id="teams-annotating-cloud-media"></span><h2>Annotating cloud-backed datasets with CVAT<a class="headerlink" href="#annotating-cloud-backed-datasets-with-cvat" title="Permalink to this headline">Â¶</a></h2>
<p>When using FiftyOne to
<a class="reference internal" href="../integrations/cvat.html#cvat-integration"><span class="std std-ref">annotate data with CVAT</span></a>,
you can optionally follow the instructions below to instruct CVAT to load media
directly from S3, GCS, or
<a class="reference external" href="https://github.com/openvinotoolkit/cvat/pull/4353">MinIO</a> buckets rather
than the default behavior of uploading copies of the media to the CVAT server.</p>
<p>First, follow
<a class="reference external" href="https://opencv.github.io/cvat/docs/manual/basics/attach-cloud-storage/">these instructions</a>
to attach a cloud storage bucket to CVAT. Then, simply provide the
<code class="code docutils literal notranslate"><span class="pre">cloud_manifest</span></code> parameter to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.annotate" title="fiftyone.core.collections.SampleCollection.annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">annotate()</span></code></a> to
specify the URL of the manifest file in your cloud bucket:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">anno_key</span> <span class="o">=</span> <span class="s2">"cloud_annotations"</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="n">anno_key</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"ground_truth"</span><span class="p">,</span>
    <span class="n">cloud_manifest</span><span class="o">=</span><span class="s2">"s3://voxel51/manifest.jsonl"</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, if your cloud manifest has the default name <code class="code docutils literal notranslate"><span class="pre">manifest.jsonl</span></code>
and exists in the root of the bucket containing the data in the sample
collection being annotated, then you can simply pass <code class="code docutils literal notranslate"><span class="pre">cloud_manifest=True</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="n">anno_key</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"ground_truth"</span><span class="p">,</span>
    <span class="n">cloud_manifest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cloud manifest file must contain all media files in the sample
collection being annotated.</p>
</div>
</div>
<div class="section" id="annotating-cloud-backed-datasets-with-v7-darwin">
<span id="teams-annotating-cloud-media-v7"></span><h2>Annotating cloud-backed datasets with V7 Darwin<a class="headerlink" href="#annotating-cloud-backed-datasets-with-v7-darwin" title="Permalink to this headline">Â¶</a></h2>
<p>When using FiftyOne to <a class="reference internal" href="../integrations/v7.html#v7-integration"><span class="std std-ref">annotate data with V7 Darwin</span></a>,
you can optionally follow the instructions below to instruct V7 to load media
directly from S3, GCS, or Azure buckets rather than the default behavior of
uploading copies of the media from your local machine.</p>
<p>First, follow
<a class="reference external" href="https://docs.v7labs.com/docs/external-storage-configuration">these instructions</a>
to configure external storage for V7. Then, simply provide the
<code class="code docutils literal notranslate"><span class="pre">external_storage</span></code> parameter to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.annotate" title="fiftyone.core.collections.SampleCollection.annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">annotate()</span></code></a> and
specify the sluggified external storage name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">anno_key</span> <span class="o">=</span> <span class="s2">"cloud_annotations"</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="n">anno_key</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"ground_truth"</span><span class="p">,</span>
    <span class="n">external_storage</span><span class="o">=</span><span class="s2">"example-darwin-storage-slug"</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="annotating-cloud-backed-datasets-with-labelbox">
<span id="teams-annotating-cloud-media-labelbox"></span><h2>Annotating cloud-backed datasets with Labelbox<a class="headerlink" href="#annotating-cloud-backed-datasets-with-labelbox" title="Permalink to this headline">Â¶</a></h2>
<p>When using FiftyOne to
<a class="reference internal" href="../integrations/labelbox.html#labelbox-integration"><span class="std std-ref">annotate data with Labelbox</span></a>, you can optionally
follow the instructions below to instruct Labelbox to load media directly from
S3 rather than the default behavior of uploading copies of the media.</p>
<p>This assumes that you have configured the
<a class="reference external" href="https://docs.labelbox.com/docs/import-aws-s3-data">S3 integration for Labelbox</a>.
If so, then you can provide the <code class="code docutils literal notranslate"><span class="pre">upload_media=False</span></code> keyword argument to
the <a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.annotate" title="fiftyone.core.collections.SampleCollection.annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">annotate()</span></code></a>
method to pass URLs for your S3-backed media when creating Labelbox data rows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="n">anno_key</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"ground_truth"</span><span class="p">,</span>
    <span class="n">label_type</span><span class="o">=</span><span class="s2">"detections"</span><span class="p">,</span>
    <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">"dog"</span><span class="p">,</span> <span class="s2">"cat"</span><span class="p">],</span>
    <span class="n">backend</span><span class="o">=</span><span class="s2">"labelbox"</span><span class="p">,</span>
    <span class="n">upload_media</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Google Cloud and Azure blob support will be added in the future. Currently,
any Google Cloud, Azure, or local media will still be uploaded to Labelbox
as usual.</p>
</div>
</div>
<div class="section" id="aws-lambda-and-google-cloud-functions">
<span id="teams-cloud-functions"></span><h2>AWS Lambda and Google Cloud Functions<a class="headerlink" href="#aws-lambda-and-google-cloud-functions" title="Permalink to this headline">Â¶</a></h2>
<p>FiftyOne Teams can easily be used in AWS Lambda Functions and Google Cloud
Functions.</p>
<p><strong>Requirements</strong></p>
<p>We recommend including Teams in your  functionâ€™s <code class="code docutils literal notranslate"><span class="pre">requirements.txt</span></code> file by
passing your token as a build environment variable, e.g.,
<code class="code docutils literal notranslate"><span class="pre">FIFTYONE_TEAMS_TOKEN</span></code> and then using the syntax below to specify the version
of the Teams client to use:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>https://${FIFTYONE_TEAMS_TOKEN}@pypi.fiftyone.ai/packages/fiftyone-0.6.6-py3-none-any.whl
</pre></div>
</div>
<p><strong>Runtime</strong></p>
<p>Lambda/GCFs cannot use services, so you must disable the media the cache by
setting the following runtime environment variable:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_MEDIA_CACHE_SIZE_BYTES</span><span class="o">=</span>-1<span class="w">  </span><span class="c1"># disable media cache</span>
</pre></div>
</div>
<p>From there, you can configure your database URI and any necessary cloud storage
credentials via runtime environment variables as you normally would, eg:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">FIFTYONE_DATABASE_URI</span><span class="o">=</span>mongodb://...
</pre></div>
</div>
</div>
</div>
</article>
</div>

</div>
</div>
<div class="pytorch-content-right" id="pytorch-content-right">
<div class="pytorch-right-menu" id="pytorch-right-menu">
<div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
<ul>
<li><a class="reference internal" href="#">Cloud-Backed Media</a><ul>
<li><a class="reference internal" href="#cloud-media-caching">Cloud media caching</a></li>
<li><a class="reference internal" href="#media-cache-config">Media cache config</a></li>
<li><a class="reference internal" href="#working-with-cloud-backed-datasets">Working with cloud-backed datasets</a></li>
<li><a class="reference internal" href="#api-reference">API reference</a><ul>
<li><a class="reference internal" href="#dataset-methods"><code class="code docutils literal notranslate"><span class="pre">Dataset</span></code> methods</a></li>
<li><a class="reference internal" href="#fiftyone-core-storage"><code class="code docutils literal notranslate"><span class="pre">fiftyone.core.storage</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#annotating-cloud-backed-datasets-with-cvat">Annotating cloud-backed datasets with CVAT</a></li>
<li><a class="reference internal" href="#annotating-cloud-backed-datasets-with-v7-darwin">Annotating cloud-backed datasets with V7 Darwin</a></li>
<li><a class="reference internal" href="#annotating-cloud-backed-datasets-with-labelbox">Annotating cloud-backed datasets with Labelbox</a></li>
<li><a class="reference internal" href="#aws-lambda-and-google-cloud-functions">AWS Lambda and Google Cloud Functions</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
<script src="../_static/js/voxel51-website.js"></script>
<script src="../_static/js/custom.js"></script>
<script src="../_static/js/vendor/popper.min.js" type="text/javascript"></script>
<script src="../_static/js/vendor/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script src="../_static/js/theme.js" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<!-- Begin Footer -->


<!-- End Footer -->
<!-- Begin Mobile Menu -->

<!-- End Mobile Menu -->
<script src="../_static/js/vendor/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>