
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Ultralytics Integration — FiftyOne 1.3.0 documentation</title>
<link href="../_static/favicon.ico" rel="shortcut icon"/>
<link href="../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
<link href="../_static/css/voxel51-website.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="albumentations.html" rel="next" title="Albumentations Integration"/>
<link href="huggingface.html" rel="prev" title="Hugging Face Integration"/>
<meta content="https://voxel51.com/wp-content/uploads/2024/03/3.24_webpages_Home_AV.png" property="og:image">
<link href="https://fonts.googleapis.com/css?family=Palanquin:400,600,700,800" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" rel="stylesheet"/>
<script src="https://tag.clearbitscripts.com/v1/pk_b9ed71c8234edd4f77326bcbfab5a4ca/tags.js"></script>
<script src="../_static/js/modernizr.min.js"></script>
</meta></head>

<body class="pytorch-body">
<div class="table-of-contents-link-wrapper">
<span>Table of Contents</span>
<a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="#"></a>
</div>
<nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu">
<div class="pytorch-side-scroll">
<div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
<div class="pytorch-left-menu-search">
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search Docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teams/index.html">FiftyOne Teams 🚀</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/index.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes/index.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheets/index.html">Cheat Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset_zoo/index.html">Dataset Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_zoo/index.html">Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../brain.html">FiftyOne Brain</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/fiftyone.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deprecation.html">Deprecation Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>
</div>
</div>
</nav>
<div class="pytorch-container">
<div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
<div class="pytorch-breadcrumbs-wrapper">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="pytorch-breadcrumbs">
<li>
<a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>
<li><a href="index.html">FiftyOne Integrations</a> &gt;</li>
<li>Ultralytics Integration</li>
<li class="pytorch-breadcrumbs-aside">
</li>
</ul>
</div>
</div>
<div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Contents
        </div>
</div>
<section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
<div class="pytorch-content-left">
<div class="rst-content style-external-links">
<div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
<div class="section" id="ultralytics-integration">
<span id="id1"></span><h1>Ultralytics Integration<a class="headerlink" href="#ultralytics-integration" title="Permalink to this headline">¶</a></h1>
<p>FiftyOne integrates natively with
<a class="reference external" href="https://github.com/ultralytics/ultralytics">Ultralytics</a>, so
you can load, fine-tune, and run inference with your favorite Ultralytics
models on your FiftyOne datasets with just a few lines of code!</p>
<div class="section" id="setup">
<span id="ultralytics-setup"></span><h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>To get started with
<a class="reference external" href="https://github.com/ultralytics/ultralytics">Ultralytics</a>, just install the
following packages:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">"ultralytics&gt;=8.1.0"</span><span class="w"> </span><span class="s2">"torch&gt;=1.8"</span>
</pre></div>
</div>
</div>
<div class="section" id="inference">
<span id="ultralytics-inference"></span><h2>Inference<a class="headerlink" href="#inference" title="Permalink to this headline">¶</a></h2>
<p>The examples below show how to run inference with various Ultralytics models on
the following sample dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suppress Ultralytics logging</span>
<span class="kn">import</span> <span class="nn">os</span><span class="p">;</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"YOLO_VERBOSE"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"False"</span>

<span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>
<span class="kn">import</span> <span class="nn">fiftyone.zoo</span> <span class="k">as</span> <span class="nn">foz</span>
<span class="kn">import</span> <span class="nn">fiftyone.utils.ultralytics</span> <span class="k">as</span> <span class="nn">fou</span>

<span class="kn">from</span> <span class="nn">ultralytics</span> <span class="kn">import</span> <span class="n">YOLO</span>

<span class="c1"># Load an example dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_dataset</span><span class="p">(</span><span class="s2">"quickstart"</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">select_fields</span><span class="p">()</span><span class="o">.</span><span class="n">keep_fields</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="image-classification">
<span id="ultralytics-image-classification"></span><h3>Image classification<a class="headerlink" href="#image-classification" title="Permalink to this headline">¶</a></h3>
<p>You can directly pass Ultralytics <code class="code docutils literal notranslate"><span class="pre">YOLO</span></code> classification models to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.apply_model" title="fiftyone.core.collections.SampleCollection.apply_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_model()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOLOv8</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8n-cls.pt"</span><span class="p">)</span>
<span class="c1"># model = YOLO("yolov8s-cls.pt")</span>
<span class="c1"># model = YOLO("yolov8m-cls.pt")</span>
<span class="c1"># model = YOLO("yolov8l-cls.pt")</span>
<span class="c1"># model = YOLO("yolov8x-cls.pt")</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"classif"</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="object-detection">
<span id="ultralytics-object-detection"></span><h3>Object detection<a class="headerlink" href="#object-detection" title="Permalink to this headline">¶</a></h3>
<p>You can directly pass Ultralytics <code class="code docutils literal notranslate"><span class="pre">YOLO</span></code> or <code class="code docutils literal notranslate"><span class="pre">RTDETR</span></code> detection models to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.apply_model" title="fiftyone.core.collections.SampleCollection.apply_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_model()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOLOv8</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8s.pt"</span><span class="p">)</span>
<span class="c1"># model = YOLO("yolov8m.pt")</span>
<span class="c1"># model = YOLO("yolov8l.pt")</span>
<span class="c1"># model = YOLO("yolov8x.pt")</span>

<span class="c1"># YOLOv5</span>
<span class="c1"># model = YOLO("yolov5s.pt")</span>
<span class="c1"># model = YOLO("yolov5m.pt")</span>
<span class="c1"># model = YOLO("yolov5l.pt")</span>
<span class="c1"># model = YOLO("yolov5x.pt")</span>

<span class="c1"># YOLOv9</span>
<span class="c1"># model = YOLO("yolov9c.pt")</span>
<span class="c1"># model = YOLO("yolov9e.pt")</span>

<span class="c1"># YOLOv10</span>
<span class="c1"># model = YOLO("yolov10n.pt)</span>
<span class="c1"># model = YOLO("yolov10s.pt)</span>
<span class="c1"># model = YOLO("yolov10m.pt)</span>
<span class="c1"># model = YOLO("yolov10l.pt)</span>
<span class="c1"># model = YOLO("yolov10x.pt)</span>

<span class="c1"># YOLOv11</span>
<span class="c1"># model = YOLO("yolo11n.pt)</span>
<span class="c1"># model = YOLO("yolo11s.pt)</span>
<span class="c1"># model = YOLO("yolo11m.pt)</span>
<span class="c1"># model = YOLO("yolo11l.pt)</span>
<span class="c1"># model = YOLO("yolo11x.pt)</span>

<span class="c1"># RTDETR</span>
<span class="c1"># model = YOLO("rtdetr-l.pt")</span>
<span class="c1"># model = YOLO("rtdetr-x.pt")</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"boxes"</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">to_detections()</span></code> utility to
manually convert Ultralytics predictions to
<a class="reference internal" href="../user_guide/using_datasets.html#object-detection"><span class="std std-ref">FiftyOne format</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iter_samples</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">filepath</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sample</span><span class="p">[</span><span class="s2">"boxes"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fou</span><span class="o">.</span><span class="n">to_detections</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">sample</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<img alt="ultralytics-boxes" class="align-center" src="../_images/ultralytics_boxes.jpg"/>
<p>You can also load any of these models directly from the
<a class="reference internal" href="../model_zoo/index.html#model-zoo"><span class="std std-ref">FiftyOne Model Zoo</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s2">"yolov5l-coco-torch"</span>
<span class="c1"># model_name = "yolov8m-coco-torch"</span>
<span class="c1"># model_name = "yolov9e-coco-torch"</span>
<span class="c1"># model_name = "yolov10s-coco-torch"</span>
<span class="c1"># model_name = "yolo11x-coco-torch"</span>
<span class="c1"># model_name = "rtdetr-l-coco-torch"</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_model</span><span class="p">(</span>
    <span class="n">model_name</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"boxes"</span><span class="p">,</span>
    <span class="n">confidence_thresh</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">iou_thresh</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use <a class="reference internal" href="../api/fiftyone.zoo.html#fiftyone.zoo.list_zoo_models" title="fiftyone.zoo.list_zoo_models"><code class="xref py py-func docutils literal notranslate"><span class="pre">list_zoo_models()</span></code></a> to see all
available YOLO models that are compatible with Ultralytics or SuperGradients:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">foz</span><span class="o">.</span><span class="n">list_zoo_models</span><span class="p">(</span><span class="n">tags</span><span class="o">=</span><span class="s2">"yolo"</span><span class="p">))</span>
</pre></div>
</div>
<p>In general, YOLO model names will contain “yolov”, followed by the version number,
then the model size (“n”, “s”, “m”,  “l”, or “x”), and an indicator of the
label classes (“coco” for MS COCO or “world” for open-world), followed by
“torch”.</p>
</div>
<div class="section" id="instance-segmentation">
<span id="ultralytics-instance-segmentation"></span><h3>Instance segmentation<a class="headerlink" href="#instance-segmentation" title="Permalink to this headline">¶</a></h3>
<p>You can directly pass Ultralytics YOLO segmentation models to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.apply_model" title="fiftyone.core.collections.SampleCollection.apply_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_model()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8s-seg.pt"</span><span class="p">)</span>
<span class="c1"># model = YOLO("yolov8m-seg.pt")</span>
<span class="c1"># model = YOLO("yolov8l-seg.pt")</span>
<span class="c1"># model = YOLO("yolov8x-seg.pt")</span>

<span class="c1"># model = YOLO("yolo11s-seg.pt")</span>
<span class="c1"># model = YOLO("yolo11m-seg.pt")</span>
<span class="c1"># model = YOLO("yolo11l-seg.pt")</span>
<span class="c1"># model = YOLO("yolo11x-seg.pt")</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"instances"</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">to_instances()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">to_polylines()</span></code> utilities to
manually convert Ultralytics predictions into the desired
<a class="reference internal" href="../user_guide/using_datasets.html#instance-segmentation"><span class="std std-ref">FiftyOne format</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iter_samples</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">filepath</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sample</span><span class="p">[</span><span class="s2">"detections"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fou</span><span class="o">.</span><span class="n">to_detections</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">sample</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fou</span><span class="o">.</span><span class="n">to_instances</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">sample</span><span class="p">[</span><span class="s2">"polylines"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fou</span><span class="o">.</span><span class="n">to_polylines</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">sample</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<img alt="ultralytics-instances" class="align-center" src="../_images/ultralytics_instances.jpg"/>
<p>You can also load YOLOv8, YOLOv9, and YOLO11 segmentation models from the
<a class="reference internal" href="../model_zoo/index.html#model-zoo"><span class="std std-ref">FiftyOne Model Zoo</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s2">"yolov8n-seg-coco-torch"</span>
<span class="c1"># model_name = "yolov8s-seg-coco-torch"</span>
<span class="c1"># model_name = "yolov8m-seg-coco-torch"</span>
<span class="c1"># model_name = "yolov8l-seg-coco-torch"</span>
<span class="c1"># model_name = "yolov8x-seg-coco-torch"</span>

<span class="c1"># model_name = "yolov9c-seg-coco-torch"</span>
<span class="c1"># model_name = "yolov9e-seg-coco-torch"</span>

<span class="c1"># model_name = "yolo11n-seg-coco-torch"</span>
<span class="c1"># model_name = "yolo11s-seg-coco-torch"</span>
<span class="c1"># model_name = "yolo11m-seg-coco-torch"</span>
<span class="c1"># model_name = "yolo11l-seg-coco-torch"</span>
<span class="c1"># model_name = "yolo11x-seg-coco-torch"</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"yolo_seg"</span><span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="keypoints">
<span id="ultralytics-keypoints"></span><h3>Keypoints<a class="headerlink" href="#keypoints" title="Permalink to this headline">¶</a></h3>
<p>You can directly pass Ultralytics YOLO pose models to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.apply_model" title="fiftyone.core.collections.SampleCollection.apply_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_model()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8s-pose.pt"</span><span class="p">)</span>
<span class="c1"># model = YOLO("yolov8m-pose.pt")</span>
<span class="c1"># model = YOLO("yolov8l-pose.pt")</span>
<span class="c1"># model = YOLO("yolov8x-pose.pt")</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"keypoints"</span><span class="p">)</span>

<span class="c1"># Store the COCO-pose keypoint skeleton so the App can render it</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">default_skeleton</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">KeypointSkeleton</span><span class="p">(</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">"nose"</span><span class="p">,</span> <span class="s2">"left eye"</span><span class="p">,</span> <span class="s2">"right eye"</span><span class="p">,</span> <span class="s2">"left ear"</span><span class="p">,</span> <span class="s2">"right ear"</span><span class="p">,</span>
        <span class="s2">"left shoulder"</span><span class="p">,</span> <span class="s2">"right shoulder"</span><span class="p">,</span> <span class="s2">"left elbow"</span><span class="p">,</span> <span class="s2">"right elbow"</span><span class="p">,</span>
        <span class="s2">"left wrist"</span><span class="p">,</span> <span class="s2">"right wrist"</span><span class="p">,</span> <span class="s2">"left hip"</span><span class="p">,</span> <span class="s2">"right hip"</span><span class="p">,</span>
        <span class="s2">"left knee"</span><span class="p">,</span> <span class="s2">"right knee"</span><span class="p">,</span> <span class="s2">"left ankle"</span><span class="p">,</span> <span class="s2">"right ankle"</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">edges</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">to_keypoints()</span></code> utility to
manually convert Ultralytics predictions to <a class="reference internal" href="../user_guide/using_datasets.html#keypoints"><span class="std std-ref">FiftyOne format</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iter_samples</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">filepath</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sample</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fou</span><span class="o">.</span><span class="n">to_keypoints</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">sample</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<img alt="ultralytics-keypoints" class="align-center" src="../_images/ultralytics_keypoints.jpg"/>
</div>
<div class="section" id="oriented-bounding-boxes">
<span id="ultralytics-oriented-bounding-boxes"></span><h3>Oriented bounding boxes<a class="headerlink" href="#oriented-bounding-boxes" title="Permalink to this headline">¶</a></h3>
<p>You can directly pass Ultralytics YOLO oriented bounding box models to
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.apply_model" title="fiftyone.core.collections.SampleCollection.apply_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_model()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8n-obb.pt"</span><span class="p">)</span>
<span class="c1"># model = YOLO("yolov8s-obb.pt")</span>
<span class="c1"># model = YOLO("yolov8m-obb.pt")</span>
<span class="c1"># model = YOLO("yolov8l-obb.pt")</span>
<span class="c1"># model = YOLO("yolov8x-obb.pt")</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"oriented_boxes"</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also load YOLOv8 oriented bounding box models from the
<a class="reference internal" href="../model_zoo/index.html#model-zoo"><span class="std std-ref">FiftyOne Model Zoo</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s2">"yolov8n-obb-dotav1-torch"</span>
<span class="c1"># model_name = "yolov8s-obb-dotav1-torch"</span>
<span class="c1"># model_name = "yolov8m-obb-dotav1-torch"</span>
<span class="c1"># model_name = "yolov8l-obb-dotav1-torch"</span>
<span class="c1"># model_name = "yolov8x-obb-dotav1-torch"</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"oriented_boxes"</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The oriented bounding box models are trained on the <a class="reference external" href="https://captain-whu.github.io/DOTA/index.html">DOTA dataset</a>, which consists of
drone images with oriented bounding boxes. The models are trained to
predict on bird’s eye view images, so applying them to regular images
may not yield good results.</p>
</div>
</div>
<div class="section" id="open-vocabulary-detection">
<span id="ultralytics-open-vocabulary-object-detection"></span><h3>Open vocabulary detection<a class="headerlink" href="#open-vocabulary-detection" title="Permalink to this headline">¶</a></h3>
<p>FiftyOne’s Ultralytics integration also supports real-time open vocabulary
object detection via
<a class="reference external" href="https://docs.ultralytics.com/models/yolo-world/">YOLO World</a>.</p>
<p>The usage syntax is the same as for regular object detection, with the caveat
that you can set the classes that the model should detect:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>
<span class="kn">import</span> <span class="nn">fiftyone.zoo</span> <span class="k">as</span> <span class="nn">foz</span>

<span class="kn">from</span> <span class="nn">ultralytics</span> <span class="kn">import</span> <span class="n">YOLO</span>

<span class="c1">## Load dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_dataset</span><span class="p">(</span>
    <span class="s2">"voc-2007"</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">"validation"</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">100</span>
<span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">select_fields</span><span class="p">()</span><span class="o">.</span><span class="n">keep_fields</span><span class="p">()</span>

<span class="c1">## Load model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8l-world.pt"</span><span class="p">)</span>
<span class="c1"># model = YOLO("yolov8s-world.pt")</span>
<span class="c1"># model =  YOLO("yolov8m-world.pt")</span>
<span class="c1"># model =  YOLO("yolov8x-world.pt")</span>

<span class="c1">## Set open vocabulary classes</span>
<span class="n">model</span><span class="o">.</span><span class="n">set_classes</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">"plant"</span><span class="p">,</span> <span class="s2">"window"</span><span class="p">,</span> <span class="s2">"keyboard"</span><span class="p">,</span> <span class="s2">"human baby"</span><span class="p">,</span> <span class="s2">"computer monitor"</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">label_field</span> <span class="o">=</span> <span class="s2">"yolo_world_detections"</span>

<span class="c1">## Apply model</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="n">label_field</span><span class="p">)</span>

<span class="c1">## Visualize the detection patches</span>
<span class="n">patches</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">to_patches</span><span class="p">(</span><span class="n">label_field</span><span class="p">)</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">patches</span><span class="p">)</span>
</pre></div>
</div>
<img alt="ultralytics-open-world-boxes" class="align-center" src="../_images/ultralytics_open_world_boxes.png"/>
<p>You can also load these open-vocabulary models from the
<a class="reference internal" href="../model_zoo/index.html#model-zoo"><span class="std std-ref">FiftyOne Model Zoo</span></a>, optionally specifying the classes that
the model should detect:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s2">"yolov8l-world-torch"</span>
<span class="c1"># model_name = "yolov8m-world-torch"</span>
<span class="c1"># model_name = "yolov8x-world-torch"</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_model</span><span class="p">(</span>
    <span class="n">model_name</span><span class="p">,</span>
    <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">"plant"</span><span class="p">,</span> <span class="s2">"window"</span><span class="p">,</span> <span class="s2">"keyboard"</span><span class="p">,</span> <span class="s2">"human baby"</span><span class="p">,</span> <span class="s2">"computer monitor"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"yolo_world_detections"</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">launch_app</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="batch-inference">
<span id="ultralytics-batch-inference"></span><h3>Batch inference<a class="headerlink" href="#batch-inference" title="Permalink to this headline">¶</a></h3>
<p>When using
<a class="reference internal" href="../api/fiftyone.core.collections.html#fiftyone.core.collections.SampleCollection.apply_model" title="fiftyone.core.collections.SampleCollection.apply_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_model()</span></code></a>,
you can request batch inference by passing the optional <code class="code docutils literal notranslate"><span class="pre">batch_size</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">label_field</span><span class="o">=</span><span class="s2">"predictions"</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p>The manual inference loops can be also executed using batch inference via the
pattern below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fiftyone.core.utils</span> <span class="kn">import</span> <span class="n">iter_batches</span>

<span class="n">filepaths</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s2">"filepath"</span><span class="p">)</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">paths</span> <span class="ow">in</span> <span class="n">iter_batches</span><span class="p">(</span><span class="n">filepaths</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
    <span class="n">predictions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fou</span><span class="o">.</span><span class="n">to_detections</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="s2">"predictions"</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="../user_guide/using_datasets.html#batch-updates"><span class="std std-ref">this section</span></a> for more information about
performing batch updates to your FiftyOne datasets.</p>
</div>
</div>
</div>
<div class="section" id="training">
<span id="ultralytics-training"></span><h2>Training<a class="headerlink" href="#training" title="Permalink to this headline">¶</a></h2>
<p>You can use FiftyOne’s builtin <a class="reference internal" href="../user_guide/export_datasets.html#yolov5dataset-export"><span class="std std-ref">YOLOv5 exporter</span></a> to
export your FiftyOne datasets for use with Ultralytics models.</p>
<p>For example, the code below prepares a random subset of the
<a class="reference internal" href="../dataset_zoo/datasets.html#dataset-zoo-open-images-v7"><span class="std std-ref">Open Images v7 dataset</span></a> for fine-tuning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fiftyone</span> <span class="k">as</span> <span class="nn">fo</span>
<span class="kn">import</span> <span class="nn">fiftyone.utils.ultralytics</span> <span class="k">as</span> <span class="nn">fou</span>
<span class="kn">import</span> <span class="nn">fiftyone.zoo</span> <span class="k">as</span> <span class="nn">foz</span>

<span class="c1"># The path to export the dataset</span>
<span class="n">EXPORT_DIR</span> <span class="o">=</span> <span class="s2">"/tmp/oiv7-yolo"</span>

<span class="c1"># Prepare train split</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_dataset</span><span class="p">(</span>
    <span class="s2">"open-images-v7"</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s2">"train"</span><span class="p">,</span>
    <span class="n">label_types</span><span class="o">=</span><span class="p">[</span><span class="s2">"detections"</span><span class="p">],</span>
    <span class="n">max_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># YOLO format requires a common classes list</span>
<span class="n">classes</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">default_classes</span>

<span class="n">train</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
    <span class="n">export_dir</span><span class="o">=</span><span class="n">EXPORT_DIR</span><span class="p">,</span>
    <span class="n">dataset_type</span><span class="o">=</span><span class="n">fo</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">YOLOv5Dataset</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"ground_truth"</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s2">"train"</span><span class="p">,</span>
    <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare validation split</span>

<span class="n">validation</span> <span class="o">=</span> <span class="n">foz</span><span class="o">.</span><span class="n">load_zoo_dataset</span><span class="p">(</span>
    <span class="s2">"open-images-v7"</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s2">"validation"</span><span class="p">,</span>
    <span class="n">label_types</span><span class="o">=</span><span class="p">[</span><span class="s2">"detections"</span><span class="p">],</span>
    <span class="n">max_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">validation</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
    <span class="n">export_dir</span><span class="o">=</span><span class="n">EXPORT_DIR</span><span class="p">,</span>
    <span class="n">dataset_type</span><span class="o">=</span><span class="n">fo</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">YOLOv5Dataset</span><span class="p">,</span>
    <span class="n">label_field</span><span class="o">=</span><span class="s2">"ground_truth"</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s2">"val"</span><span class="p">,</span>  <span class="c1"># Ultralytics uses 'val'</span>
    <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>From here,
<a class="reference external" href="https://docs.ultralytics.com/modes/train">training an Ultralytics model</a> is
as simple as passing the path to the dataset YAML file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ultralytics</span> <span class="kn">import</span> <span class="n">YOLO</span>

<span class="c1"># The path to the `dataset.yaml` file we created above</span>
<span class="n">YAML_FILE</span> <span class="o">=</span> <span class="s2">"/tmp/oiv7-yolo/dataset.yaml"</span>

<span class="c1"># Load a model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolov8s.pt"</span><span class="p">)</span>  <span class="c1"># load a pretrained model</span>
<span class="c1"># model = YOLO("yolov8s.yaml")  # build a model from scratch</span>

<span class="c1"># Train the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">YAML_FILE</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Evaluate model on the validation set</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">val</span><span class="p">()</span>

<span class="c1"># Export the model</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">"onnx"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</article>
</div>

</div>
</div>
<div class="pytorch-content-right" id="pytorch-content-right">
<div class="pytorch-right-menu" id="pytorch-right-menu">
<div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
<ul>
<li><a class="reference internal" href="#">Ultralytics Integration</a><ul>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#inference">Inference</a><ul>
<li><a class="reference internal" href="#image-classification">Image classification</a></li>
<li><a class="reference internal" href="#object-detection">Object detection</a></li>
<li><a class="reference internal" href="#instance-segmentation">Instance segmentation</a></li>
<li><a class="reference internal" href="#keypoints">Keypoints</a></li>
<li><a class="reference internal" href="#oriented-bounding-boxes">Oriented bounding boxes</a></li>
<li><a class="reference internal" href="#open-vocabulary-detection">Open vocabulary detection</a></li>
<li><a class="reference internal" href="#batch-inference">Batch inference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#training">Training</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
<script src="../_static/js/voxel51-website.js"></script>
<script src="../_static/js/custom.js"></script>
<script src="../_static/js/vendor/popper.min.js" type="text/javascript"></script>
<script src="../_static/js/vendor/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script src="../_static/js/theme.js" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<!-- Begin Footer -->


<!-- End Footer -->
<!-- Begin Mobile Menu -->

<!-- End Mobile Menu -->
<script src="../_static/js/vendor/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>